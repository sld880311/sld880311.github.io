<!DOCTYPE html>
<html lang="zh-CN,en,default">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/avatar.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/avatar.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/avatar.png">
  <link rel="mask-icon" href="/images/avatar.png" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.sunliaodong.cn","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":{"gitalk":{"order":-2}}},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="说明备份的目的 做灾难恢复：对损坏的数据进行恢复和还原 需求改变：因需求改变而需要把数据还原到改变以前 测试：测试新功能是否可用  备份需要考虑的问题 可以容忍丢失多长时间的数据； 恢复数据要在多长时间内完； 恢复的时候是否需要持续提供服务； 恢复的对象，是整个库，多个表，还是单个库，单个表。">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL之备份与恢复">
<meta property="og:url" content="https://www.sunliaodong.cn/2021/02/04/MySQL%E4%B9%8B%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D/index.html">
<meta property="og:site_name" content="一蓑烟雨任平生">
<meta property="og:description" content="说明备份的目的 做灾难恢复：对损坏的数据进行恢复和还原 需求改变：因需求改变而需要把数据还原到改变以前 测试：测试新功能是否可用  备份需要考虑的问题 可以容忍丢失多长时间的数据； 恢复数据要在多长时间内完； 恢复的时候是否需要持续提供服务； 恢复的对象，是整个库，多个表，还是单个库，单个表。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-02-04T12:43:21.000Z">
<meta property="article:modified_time" content="2021-02-04T12:44:26.403Z">
<meta property="article:author" content="Theodore Sun">
<meta property="article:tag" content="MySQL">
<meta property="article:tag" content="备份">
<meta property="article:tag" content="恢复">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://www.sunliaodong.cn/2021/02/04/MySQL%E4%B9%8B%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>MySQL之备份与恢复 | 一蓑烟雨任平生</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="一蓑烟雨任平生" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">一蓑烟雨任平生</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">个人成长日记</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">154</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">27</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">100</span></a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>日程表</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.sunliaodong.cn/2021/02/04/MySQL%E4%B9%8B%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Theodore Sun">
      <meta itemprop="description" content="心之所向，素履以往">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一蓑烟雨任平生">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MySQL之备份与恢复
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-02-04 20:43:21 / 修改时间：20:44:26" itemprop="dateCreated datePublished" datetime="2021-02-04T20:43:21+08:00">2021-02-04</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MySQL/" itemprop="url" rel="index"><span itemprop="name">MySQL</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>35k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>32 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h2><h3 id="备份的目的"><a href="#备份的目的" class="headerlink" title="备份的目的"></a>备份的目的</h3><ol>
<li>做灾难恢复：对损坏的数据进行恢复和还原</li>
<li>需求改变：因需求改变而需要把数据还原到改变以前</li>
<li>测试：测试新功能是否可用</li>
</ol>
<h3 id="备份需要考虑的问题"><a href="#备份需要考虑的问题" class="headerlink" title="备份需要考虑的问题"></a>备份需要考虑的问题</h3><ol>
<li>可以容忍丢失多长时间的数据；</li>
<li>恢复数据要在多长时间内完；</li>
<li>恢复的时候是否需要持续提供服务；</li>
<li>恢复的对象，是整个库，多个表，还是单个库，单个表。<a id="more"></a>

</li>
</ol>
<h3 id="备份的类型"><a href="#备份的类型" class="headerlink" title="备份的类型"></a>备份的类型</h3><h4 id="根据是否需要数据库离线"><a href="#根据是否需要数据库离线" class="headerlink" title="根据是否需要数据库离线"></a>根据是否需要数据库离线</h4><ol>
<li>冷备（cold backup）：需要关mysql服务，读写请求均不允许状态下进行；</li>
<li>温备（warm backup）： 服务在线，但仅支持读请求，不允许写请求；</li>
<li>热备（hot backup）：备份的同时，业务不受影响。</li>
</ol>
<blockquote>
<p>注：</p>
<blockquote>
<p>1、这种类型的备份，取决于业务的需求，而不是备份工具<br>2、MyISAM不支持热备，InnoDB支持热备，但是需要专门的工具  </p>
</blockquote>
</blockquote>
<h4 id="根据要备份的数据集合的范围"><a href="#根据要备份的数据集合的范围" class="headerlink" title="根据要备份的数据集合的范围"></a>根据要备份的数据集合的范围</h4><ol>
<li>完全备份：full backup，备份全部字符集。</li>
<li>增量备份: incremental backup 上次完全备份或增量备份以来改变了的数据，不能单独使用，要借助完全备份，备份的频率取决于数据的更新频率。</li>
<li>差异备份：differential backup 上次完全备份以来改变了的数据。</li>
</ol>
<p>建议的恢复策略：  </p>
<ol>
<li>完全+增量+二进制日志</li>
<li>完全+差异+二进制日志</li>
</ol>
<h4 id="根据备份数据或文件"><a href="#根据备份数据或文件" class="headerlink" title="根据备份数据或文件"></a>根据备份数据或文件</h4><style type="text/css">
.tg  {border-collapse:collapse;border-color:#bbb;border-spacing:0;}
.tg td{background-color:#E0FFEB;border-color:#bbb;border-style:solid;border-width:1px;color:#594F4F;
  font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;word-break:normal;}
.tg th{background-color:#9DE0AD;border-color:#bbb;border-style:solid;border-width:1px;color:#493F3F;
  font-family:Arial, sans-serif;font-size:14px;font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;}
.tg .tg-0lax{text-align:left;vertical-align:top}
</style>
<table class="tg">
<thead>
  <tr>
    <th class="tg-0lax">&nbsp;&nbsp;&nbsp;类型&nbsp;&nbsp;&nbsp;</th>
    <th class="tg-0lax">&nbsp;&nbsp;&nbsp;优点&nbsp;&nbsp;&nbsp;</th>
    <th class="tg-0lax">&nbsp;&nbsp;&nbsp;缺点&nbsp;&nbsp;&nbsp;</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;物理备份&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;直接备份数据文件&nbsp;&nbsp;&nbsp;备份和恢复操作都比较简单，能够跨mysql的版本，&nbsp;&nbsp;&nbsp;恢复速度快，属于文件系统级别的&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;不要假设备份一定可用，要测试&nbsp;&nbsp;&nbsp;mysql&gt;check&nbsp;&nbsp;&nbsp;tables；检测表是否可用&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;逻辑备份&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;备份表中的数据和代码&nbsp;&nbsp;&nbsp;恢复简单、备份的结果为ASCII文件，可以编辑&nbsp;&nbsp;&nbsp;与存储引擎无关&nbsp;&nbsp;&nbsp;可以通过网络备份和恢复&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;备份或恢复都需要mysql服务器进程参与&nbsp;&nbsp;&nbsp;备份结果占据更多的空间，&nbsp;&nbsp;&nbsp;浮点数可能会丢失精度&nbsp;&nbsp;&nbsp;还原之后，缩影需要重建&nbsp;&nbsp;&nbsp;</td>
  </tr>
</tbody>
</table>

<h3 id="备份对象"><a href="#备份对象" class="headerlink" title="备份对象"></a>备份对象</h3><ol>
<li>数据；</li>
<li>配置文件；</li>
<li>代码：存储过程、存储函数、触发器</li>
<li>os相关的配置文件</li>
<li>复制相关的配置</li>
<li>二进制日志</li>
</ol>
<h2 id="数据库备份与还原"><a href="#数据库备份与还原" class="headerlink" title="数据库备份与还原"></a>数据库备份与还原</h2><h3 id="利用select-into-outfile实现数据的备份与还原"><a href="#利用select-into-outfile实现数据的备份与还原" class="headerlink" title="利用select into outfile实现数据的备份与还原"></a>利用select into outfile实现数据的备份与还原</h3><h4 id="备份数据"><a href="#备份数据" class="headerlink" title="备份数据"></a>备份数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> databases;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="operator">|</span> Database           <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="operator">|</span> information_schema <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> mysql              <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> performance_schema <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> sunld_db           <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> sys                <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="number">6</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> use sunld_db;</span><br><span class="line">Database changed</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_sunld_user;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+------+</span></span><br><span class="line"><span class="operator">|</span> id   <span class="operator">|</span> name <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span> a    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span> 啊   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_sunld_user <span class="keyword">into</span> outfile <span class="string">&#x27;/var/lib/mysql/t_sunld_user_01.txt&#x27;</span>;</span><br><span class="line">ERROR <span class="number">1290</span> (HY000): The MySQL server <span class="keyword">is</span> <span class="keyword">running</span> <span class="keyword">with</span> the <span class="comment">--secure-file-priv option so it cannot execute this statement</span></span><br></pre></td></tr></table></figure>
<h5 id="错误分析"><a href="#错误分析" class="headerlink" title="错误分析"></a>错误分析</h5><p>出现这个问题的原因是因为启动MySQL的时候使用了–secure-file-priv这个参数，这个参数的主要目的就是限制LOAD DATA INFILE或者SELECT INTO OUTFILE之类文件的目录位置，我们可以使用。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;secure_file_priv&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+-----------------------+</span></span><br><span class="line"><span class="operator">|</span> Variable_name    <span class="operator">|</span> <span class="keyword">Value</span>                 <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+-----------------------+</span></span><br><span class="line"><span class="operator">|</span> secure_file_priv <span class="operator">|</span> <span class="operator">/</span>var<span class="operator">/</span>lib<span class="operator">/</span>mysql<span class="operator">-</span>files<span class="operator">/</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+-----------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure>
<p>如果要解决这个问题，我们可以通过下面2种方式：</p>
<ol>
<li>将你要导入或导出的文件位置指定到你设置的路径里</li>
<li>由于不能动态修改，我们可以修改my.cnf里关于这个选项的配置，然后重启即可。</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_sunld_user <span class="keyword">into</span> outfile <span class="string">&#x27;/var/lib/mysql-files/t_sunld_user_01.txt&#x27;</span>;</span><br><span class="line">Query OK, <span class="number">2</span> <span class="keyword">rows</span> affected (<span class="number">0.08</span> sec)</span><br></pre></td></tr></table></figure>
<h5 id="文件内容"><a href="#文件内容" class="headerlink" title="文件内容"></a>文件内容</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@]# pwd</span><br><span class="line"><span class="operator">/</span>var<span class="operator">/</span>lib<span class="operator">/</span>mysql<span class="operator">-</span>files</span><br><span class="line">[root@]# cat t_sunld_user_01.txt</span><br><span class="line"><span class="number">1</span>	a</span><br><span class="line"><span class="number">2</span>	啊</span><br></pre></td></tr></table></figure>
<p>发现文件只是一个文本文件，如果导入的话需要使用load data infile进行数据恢复</p>
<h4 id="数据恢复"><a href="#数据恢复" class="headerlink" title="数据恢复"></a>数据恢复</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">delete</span> <span class="keyword">from</span> t_sunld_user;</span><br><span class="line">Query OK, <span class="number">2</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_sunld_user;</span><br><span class="line"><span class="keyword">Empty</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> load data infile <span class="string">&#x27;/var/lib/mysql-files/t_sunld_user_01.txt&#x27;</span> <span class="keyword">into</span> <span class="keyword">table</span> t_sunld_user;</span><br><span class="line">Query OK, <span class="number">2</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line">Records: <span class="number">2</span>  Deleted: <span class="number">0</span>  Skipped: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_sunld_user;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+------+</span></span><br><span class="line"><span class="operator">|</span> id   <span class="operator">|</span> name <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span> a    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span> 啊   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<h4 id="其他例子"><a href="#其他例子" class="headerlink" title="其他例子"></a>其他例子</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> `metadatakeys` <span class="keyword">INTO</span> OUTFILE <span class="string">&#x27;D:/outfile.txt&#x27;</span> FIELDS TERMINATED <span class="keyword">BY</span> <span class="string">&#x27;|&#x27;</span> ENCLOSED <span class="keyword">BY</span> <span class="string">&#x27;&quot;&#x27;</span> LINES TERMINATED <span class="keyword">BY</span> <span class="string">&#x27;\r\n&#x27;</span></span><br><span class="line">LOAD DATA INFILE <span class="string">&#x27;D:/outfile.txt&#x27;</span> <span class="keyword">INTO</span> <span class="keyword">TABLE</span> `metadatakeys`FIELDS TERMINATED <span class="keyword">BY</span> <span class="string">&#x27;|&#x27;</span> ENCLOSED <span class="keyword">BY</span> <span class="string">&#x27;&quot;&#x27;</span> LINES TERMINATED <span class="keyword">BY</span> <span class="string">&#x27;\r\n&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="使用mysqldump备份数据和还原数据"><a href="#使用mysqldump备份数据和还原数据" class="headerlink" title="使用mysqldump备份数据和还原数据"></a>使用mysqldump备份数据和还原数据</h3><h4 id="说明-1"><a href="#说明-1" class="headerlink" title="说明"></a>说明</h4><ol>
<li>mysqldump命令将数据库中的数据备份成一个文本文件。表的结构和表中的数据将存储在生成的文本文件中。</li>
<li>mysqldump命令的工作原理很简单。它先查出需要备份的表的结构，再在文本文件中生成一个CREATE语句。然后，将表中的所有记录转换成一条INSERT语句。然后通过这些语句，就能够创建表并插入数据。</li>
<li>抛开源码不谈，其实我们可以通过打开general log，查看mysqldump全库备份时执行的命令来了解mysqldump背后的原理。</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">打开general log</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">set</span> <span class="keyword">global</span> general_log<span class="operator">=</span><span class="keyword">on</span>;</span><br><span class="line">其中，general log的存放路径可通过以下命令查看</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%general_log_file%&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h4 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Usage: mysqldump [OPTIONS] database [tables]</span><br><span class="line">OR     mysqldump [OPTIONS] --databases [OPTIONS] DB1 [DB2 DB3...]</span><br><span class="line">OR     mysqldump [OPTIONS] --all-databases [OPTIONS]</span><br><span class="line">mysqldump -u username -p dbname table1 table2 ...-&gt; BackupName.sql</span><br><span class="line">其中：</span><br><span class="line">dbname参数表示数据库的名称；</span><br><span class="line">table1和table2参数表示需要备份的表的名称，为空则整个数据库备份；</span><br><span class="line">BackupName.sql参数表设计备份文件的名称，文件名前面可以加上一个绝对路径。通常将数据库被分成一个后缀名为sql的文件；</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="备份一个数据库"><a href="#备份一个数据库" class="headerlink" title="备份一个数据库"></a>备份一个数据库</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -uroot -p123456a? cloudos_db t_sunld_user &gt; back001.sql</span><br></pre></td></tr></table></figure>
<h5 id="备份多个数据库"><a href="#备份多个数据库" class="headerlink" title="备份多个数据库"></a>备份多个数据库</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">语法：</span><br><span class="line">mysqldump -u username -p --databases dbname2 dbname2 &gt; Backup.sql</span><br><span class="line">加上了--databases选项，然后后面跟多个数据库</span><br><span class="line">mysqldump -u root -p --databases <span class="built_in">test</span> mysql &gt; backup.sql</span><br></pre></td></tr></table></figure>
<h5 id="备份全部数据库"><a href="#备份全部数据库" class="headerlink" title="备份全部数据库"></a>备份全部数据库</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysqldump命令备份所有数据库的语法如下：</span><br><span class="line">mysqldump -u username -p -all-databases &gt; BackupName.sql</span><br><span class="line">示例：</span><br><span class="line">mysqldump -u -root -p -all-databases &gt; all.sql</span><br></pre></td></tr></table></figure>
<h4 id="施加读锁的方式"><a href="#施加读锁的方式" class="headerlink" title="施加读锁的方式"></a>施加读锁的方式</h4><p>mysqldump 常用来做温备，所以我们首先需要对想备份的数据施加读锁</p>
<h5 id="直接在备份的时候添加选项"><a href="#直接在备份的时候添加选项" class="headerlink" title="直接在备份的时候添加选项"></a>直接在备份的时候添加选项</h5><ol>
<li>–lock-all-tables 是对要备份的数据库的所有表施加读锁</li>
<li>–lock-table 仅对单张表施加读锁，即使是备份整个数据库，它也是在我们备份某张表的时候才对该表施加读锁，因此适用于备份单张表</li>
</ol>
<h5 id="在服务器端书写命令"><a href="#在服务器端书写命令" class="headerlink" title="在服务器端书写命令"></a>在服务器端书写命令</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; flush tables with <span class="built_in">read</span> lock; 施加锁，表示把位于内存上的表统统都同步到磁盘上去，然后施加读锁</span><br><span class="line">mysql&gt; flush tables with <span class="built_in">read</span> lock;释放读锁</span><br></pre></td></tr></table></figure>
<p>但这对于InnoDB存储引擎来讲，虽然你也能够请求道读锁，但是不代表它的所有数据都已经同步到磁盘上，因此当面对InnoDB的时候，我们要使用mysql&gt; show engine innodb status; 看看InnoDB所有的数据都已经同步到磁盘上去了，才进行备份操作。</p>
<h4 id="备份策略"><a href="#备份策略" class="headerlink" title="备份策略"></a>备份策略</h4><p>完全备份+增量备份+二进制日志</p>
<h4 id="完整备份数据库"><a href="#完整备份数据库" class="headerlink" title="完整备份数据库"></a>完整备份数据库</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -uroot -p123456a? --single-transaction --master-data=2 --databases sunld_db &gt; /var/lib/mysql/sunld_db_`date +%F`.sql</span><br><span class="line">mysqldump: [Warning] Using a password on the <span class="built_in">command</span> line interface can be insecure.</span><br><span class="line"></span><br><span class="line">--single-transaction: 基于此选项能实现热备InnoDB表；因此，不需要同时使用--lock-all-tables；</span><br><span class="line">--master-data=2  记录备份那一时刻的二进制日志的位置，并且注释掉，1是不注释的</span><br><span class="line">--databases hellodb 指定备份的数据库</span><br></pre></td></tr></table></figure>
<h5 id="文件信息"><a href="#文件信息" class="headerlink" title="文件信息"></a>文件信息</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@ mysql]<span class="comment"># pwd</span></span><br><span class="line">/var/lib/mysql</span><br><span class="line">[root@ mysql]<span class="comment"># ll|grep sunld_db</span></span><br><span class="line">drwxr-x--- 2 mysql mysql         65 Dec 19 21:57 sunld_db</span><br><span class="line">-rw-r--r-- 1 root  root        2232 Dec 19 22:03 sunld_db_2017-12-19.sql</span><br></pre></td></tr></table></figure>
<h5 id="文件内容-1"><a href="#文件内容-1" class="headerlink" title="文件内容"></a>文件内容</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">#文件中以“<span class="comment">--”开头的都是SQL语言的注释</span></span><br><span class="line">#以&quot;/*!40101&quot;等形式开头的是与MySQL有关的注释。</span><br><span class="line">#<span class="number">40101</span>是MySQL数据库的版本号，如果MySQL的版本比<span class="number">1.11</span>高，则<span class="comment">/*!40101和*/</span>之间的内容就被当做<span class="keyword">SQL</span>命令来执行，如果比<span class="number">4.1</span><span class="number">.1</span>低就会被当做注释。</span><br><span class="line"></span><br><span class="line"><span class="comment">-- MySQL dump 10.13  Distrib 5.7.17, for Linux (x86_64)#文件的开头会记录MySQL的版本、备份的主机名和数据库名。</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- Host: localhost    Database: sunld_db</span></span><br><span class="line"><span class="comment">-- ------------------------------------------------------</span></span><br><span class="line"><span class="comment">-- Server version	5.7.17-log</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET NAMES utf8 */</span>;</span><br><span class="line"><span class="comment">/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */</span>;</span><br><span class="line"><span class="comment">/*!40103 SET TIME_ZONE=&#x27;+00:00&#x27; */</span>;</span><br><span class="line"><span class="comment">/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */</span>;</span><br><span class="line"><span class="comment">/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE=&#x27;NO_AUTO_VALUE_ON_ZERO&#x27; */</span>;</span><br><span class="line"><span class="comment">/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */</span>;</span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- Position to start replication or point-in-time recovery from</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- CHANGE MASTER TO MASTER_LOG_FILE=&#x27;mysql-bin.000016&#x27;, MASTER_LOG_POS=143358362;#记录了二进制日志的位置 </span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- Current Database: `sunld_db`</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="keyword">CREATE</span> DATABASE <span class="comment">/*!32312 IF NOT EXISTS*/</span> `sunld_db` <span class="comment">/*!40100 DEFAULT CHARACTER SET utf8 */</span>;</span><br><span class="line">USE `sunld_db`;</span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- Table structure for table `t_sunld_user`</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `t_sunld_user`;</span><br><span class="line"><span class="comment">/*!40101 SET @saved_cs_client     = @@character_set_client */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET character_set_client = utf8 */</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `t_sunld_user` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `name` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin;</span><br><span class="line"><span class="comment">/*!40101 SET character_set_client = @saved_cs_client */</span>;</span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- Dumping data for table `t_sunld_user`</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line">LOCK TABLES `t_sunld_user` WRITE;</span><br><span class="line"><span class="comment">/*!40000 ALTER TABLE `t_sunld_user` DISABLE KEYS */</span>;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `t_sunld_user` <span class="keyword">VALUES</span> (<span class="number">1</span>,<span class="string">&#x27;a&#x27;</span>),(<span class="number">2</span>,<span class="string">&#x27;啊&#x27;</span>);</span><br><span class="line"><span class="comment">/*!40000 ALTER TABLE `t_sunld_user` ENABLE KEYS */</span>;</span><br><span class="line">UNLOCK TABLES;</span><br><span class="line"><span class="comment">/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET SQL_MODE=@OLD_SQL_MODE */</span>;</span><br><span class="line"><span class="comment">/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */</span>;</span><br><span class="line"><span class="comment">/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */</span>;</span><br><span class="line"><span class="comment">/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */</span>;</span><br><span class="line"><span class="comment">-- Dump completed on 2017-12-19 22:03:10</span></span><br></pre></td></tr></table></figure>
<h4 id="日志文件内容general-log"><a href="#日志文件内容general-log" class="headerlink" title="日志文件内容general log"></a>日志文件内容general log</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">11</span>:<span class="number">00</span>:<span class="number">59</span>    <span class="number">14</span> <span class="keyword">Connect</span>   root<span class="variable">@localhost</span> <span class="keyword">on</span></span><br><span class="line">Query     <span class="comment">/*!40100 SET @@SQL_MODE=&#x27;&#x27; */</span></span><br><span class="line">Query     <span class="comment">/*!40103 SET TIME_ZONE=&#x27;+00:00&#x27; */</span></span><br><span class="line">Query     FLUSH <span class="comment">/*!40101 LOCAL */</span> TABLES</span><br><span class="line">Query     FLUSH TABLES <span class="keyword">WITH</span> READ LOCK</span><br><span class="line">Query     <span class="keyword">SET</span> SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ</span><br><span class="line">Query     <span class="keyword">START</span> TRANSACTION <span class="comment">/*!40100 WITH CONSISTENT SNAPSHOT */</span></span><br><span class="line">Query     <span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;gtid\_mode&#x27;</span></span><br><span class="line">Query     <span class="keyword">SHOW</span> MASTER STATUS</span><br><span class="line">Query     UNLOCK TABLES</span><br><span class="line">Query     <span class="keyword">SELECT</span> LOGFILE_GROUP_NAME, FILE_NAME, TOTAL_EXTENTS, INITIAL_SIZE, ENGINE, EXTRA <span class="keyword">FROM</span> INFORMATION_SCHEMA.FILES <span class="keyword">WHERE</span> FILE_TYPE <span class="operator">=</span> <span class="string">&#x27;UNDO LOG&#x27;</span> <span class="keyword">AND</span> FILE_NAME <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> LOGFILE_GROUP_NAME, FILE_NAME, ENGINE <span class="keyword">ORDER</span> <span class="keyword">BY</span> LOGFILE_GROUP_NAME</span><br><span class="line">Query     <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> TABLESPACE_NAME, FILE_NAME, LOGFILE_GROUP_NAME, EXTENT_SIZE, INITIAL_SIZE, ENGINE <span class="keyword">FROM</span> INFORMATION_SCHEMA.FILES <span class="keyword">WHERE</span> FILE_TYPE <span class="operator">=</span> <span class="string">&#x27;DATAFILE&#x27;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> TABLESPACE_NAME, LOGFILE_GROUP_NAME</span><br><span class="line">Query     <span class="keyword">SHOW</span> DATABASES</span><br><span class="line">Query     <span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;ndbinfo\_version&#x27;</span></span><br></pre></td></tr></table></figure>
<h5 id="FLUSH-40101-LOCAL-TABLES"><a href="#FLUSH-40101-LOCAL-TABLES" class="headerlink" title="FLUSH /*!40101 LOCAL */ TABLES"></a>FLUSH /*!40101 LOCAL */ TABLES</h5><p>Closes all open tables, forces all tables in use to be closed, and flushes the query cache.</p>
<h5 id="FLUSH-TABLES-WITH-READ-LOCK"><a href="#FLUSH-TABLES-WITH-READ-LOCK" class="headerlink" title="FLUSH TABLES WITH READ LOCK"></a>FLUSH TABLES WITH READ LOCK</h5><p>执行flush tables操作，并加一个全局读锁，很多童鞋可能会好奇，这两个命令貌似是重复的，为什么不在第一次执行flush tables操作的时候加上锁呢？  </p>
<p>下面看看源码中的解释：</p>
<blockquote>
<p>We do first a FLUSH TABLES. If a long update is running, the FLUSH TABLES,will wait but will not stall the whole mysqld, and when the long update is done the FLUSH TABLES WITH READ LOCK will start and succeed quickly. So,FLUSH TABLES is to lower the probability of a stage where both mysqldump and most client connections are stalled. Of course, if a second long update starts between the two FLUSHes, we have that bad stall.</p>
</blockquote>
<p>简而言之，是为了避免较长的事务操作造成FLUSH TABLES WITH READ LOCK操作迟迟得不到锁，但同时又阻塞了其它客户端操作。</p>
<h5 id="SET-SESSION-TRANSACTION-ISOLATION-LEVEL-REPEATABLE-READ"><a href="#SET-SESSION-TRANSACTION-ISOLATION-LEVEL-REPEATABLE-READ" class="headerlink" title="SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ"></a>SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ</h5><p>设置当前会话的事务隔离等级为RR，RR可避免不可重复读和幻读。</p>
<h5 id="START-TRANSACTION-40100-WITH-CONSISTENT-SNAPSHOT"><a href="#START-TRANSACTION-40100-WITH-CONSISTENT-SNAPSHOT" class="headerlink" title="START TRANSACTION /*!40100 WITH CONSISTENT SNAPSHOT */"></a>START TRANSACTION /*!40100 WITH CONSISTENT SNAPSHOT */</h5><ol>
<li>获取当前数据库的快照，这个是由mysqldump中–single-transaction决定的。</li>
<li>这个只适用于支持事务的表，在MySQL中，只有Innodb。</li>
</ol>
<blockquote>
<p>注意：  </p>
<blockquote>
<p>START TRANSACTION和START TRANSACTION WITH CONSISTENT SNAPSHOT并不一样，<br>START TRANSACTION WITH CONSISTENT SNAPSHOT是开启事务的一致性快照。  </p>
</blockquote>
</blockquote>
<p>下面看看官方的说法，  </p>
<p>The WITH CONSISTENT SNAPSHOT modifier starts a consistent read for storage engines that are capable of it. This applies only to InnoDB. The effect is the same as issuing a START TRANSACTION followed by a SELECT from any InnoDB table.  </p>
<p>简而言之，就是开启事务并对所有表执行了一次SELECT操作，这样可保证备份时，在任意时间点执行select * from table得到的数据和执行START TRANSACTION WITH CONSISTENT SNAPSHOT时的数据一致。  </p>
<blockquote>
<p>注意，WITH CONSISTENT SNAPSHOT只在RR隔离级别下有效。  </p>
</blockquote>
<h5 id="SHOW-MASTER-STATUS"><a href="#SHOW-MASTER-STATUS" class="headerlink" title="SHOW MASTER STATUS"></a>SHOW MASTER STATUS</h5><p>这个是由–master-data决定的，记录了开始备份时，binlog的状态信息，包括MASTER_LOG_FILE和MASTER_LOG_POS</p>
<h5 id="UNLOCK-TABLES"><a href="#UNLOCK-TABLES" class="headerlink" title="UNLOCK TABLES"></a>UNLOCK TABLES</h5><p>释放锁。</p>
<h4 id="在服务器端执行相关sql，然后查看二进制日志的记录位置"><a href="#在服务器端执行相关sql，然后查看二进制日志的记录位置" class="headerlink" title="在服务器端执行相关sql，然后查看二进制日志的记录位置"></a>在服务器端执行相关sql，然后查看二进制日志的记录位置</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">insert</span> <span class="keyword">into</span> test1 <span class="keyword">values</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>);#准备数据</span><br><span class="line">ERROR <span class="number">1136</span> (<span class="number">21</span>S01): <span class="keyword">Column</span> count doesn<span class="string">&#x27;t match value count at row 1</span></span><br><span class="line"><span class="string">mysql&gt; insert into test1 values (1),(2),(3);</span></span><br><span class="line"><span class="string">Query OK, 3 rows affected (0.01 sec)</span></span><br><span class="line"><span class="string">Records: 3  Duplicates: 0  Warnings: 0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mysql&gt; select * from test1;</span></span><br><span class="line"><span class="string">+------+</span></span><br><span class="line"><span class="string">| id   |</span></span><br><span class="line"><span class="string">+------+</span></span><br><span class="line"><span class="string">|    1 |</span></span><br><span class="line"><span class="string">|    2 |</span></span><br><span class="line"><span class="string">|    3 |</span></span><br><span class="line"><span class="string">+------+</span></span><br><span class="line"><span class="string">3 rows in set (0.00 sec)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#查看二进制的记录位置，从备份文件里边记录的位置到我们此时的位置，即为增量的部分</span></span><br><span class="line"><span class="string">mysql&gt; show master status;</span></span><br><span class="line"><span class="string">+------------------+-----------+--------------+------------------+-------------------+</span></span><br><span class="line"><span class="string">| File             | Position  | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |</span></span><br><span class="line"><span class="string">+------------------+-----------+--------------+------------------+-------------------+</span></span><br><span class="line"><span class="string">| mysql-bin.000016 | 168329475 |              |                  |                   |</span></span><br><span class="line"><span class="string">+------------------+-----------+--------------+------------------+-------------------+</span></span><br><span class="line"><span class="string">1 row in set (0.00 sec)</span></span><br></pre></td></tr></table></figure>
<h4 id="增量备份"><a href="#增量备份" class="headerlink" title="增量备份"></a>增量备份</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqlbinlog --no-defaults --start-position=143358362 --stop-position=168329475  /var/lib/mysql/mysql-bin.000016 &gt; /var/lib/mysql/sunld_db_`date +%F_%H`.sql</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">set</span> sql_log_bin<span class="operator">=</span><span class="number">0</span>;  关闭二进制日志</span><br><span class="line">mysql<span class="operator">&gt;</span> flush logs; 滚动下日志</span><br></pre></td></tr></table></figure>
<h4 id="恢复数据"><a href="#恢复数据" class="headerlink" title="恢复数据"></a>恢复数据</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p [dbname] &lt; backup.sql</span><br><span class="line">示例：</span><br><span class="line">mysql -u root -p &lt; backup.sql</span><br><span class="line">[root@www ]<span class="comment"># mysql &lt; /var/lib/mysql/sunld_db_2017-12-19.sql  //导入完全备份文件</span></span><br><span class="line">[root@www ]<span class="comment"># mysql &lt; /var/lib/mysql/sunld_db_2017-12-19_22.sql //导入增量备份文件</span></span><br></pre></td></tr></table></figure>
<h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><ol>
<li>真正在生产环境中，我们应该导出的是整个mysql服务器中的数据，而不是单个库，因此应该使用–all-databases</li>
<li>在导出二进制日志的时候，可以直接复制文件即可，但是要注意的是，备份之前滚动下日志。</li>
</ol>
<h3 id="直接复制整个数据库目录"><a href="#直接复制整个数据库目录" class="headerlink" title="直接复制整个数据库目录"></a>直接复制整个数据库目录</h3><p>MySQL有一种非常简单的备份方法，就是将MySQL中的数据库文件直接复制出来。这是最简单，速度最快的方法。<br>不过在此之前，要先将服务器停止，这样才可以保证在复制期间数据库的数据不会发生变化。如果在复制数据库的过程中还有数据写入，就会造成数据不一致。这种情况在开发环境可以，但是在生产环境中很难允许备份服务器。</p>
<blockquote>
<p>注意：这种方法不适用于InnoDB存储引擎的表，而对于MyISAM存储引擎的表很方便。同时，还原时MySQL的版本最好相同。</p>
</blockquote>
<h3 id="使用mysqlhotcopy工具快速备份"><a href="#使用mysqlhotcopy工具快速备份" class="headerlink" title="使用mysqlhotcopy工具快速备份"></a>使用mysqlhotcopy工具快速备份</h3><p>mysqlhotcopy支持不停止MySQL服务器备份。而且，mysqlhotcopy的备份方式比mysqldump快。mysqlhotcopy是一个perl脚本，主要在Linux系统下使用。其使用LOCK TABLES、FLUSH TABLES和cp来进行快速备份。<br>原理：先将需要备份的数据库加上一个读锁，然后用FLUSH TABLES将内存中的数据写回到硬盘上的数据库，最后，把需要备份的数据库文件复制到目标目录。<br>命令格式如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysqlhotcopy [option] dbname1 dbname2 backupDir/</span><br><span class="line">dbname：数据库名称；</span><br><span class="line">backupDir：备份到哪个文件夹下；</span><br><span class="line">常用选项：</span><br><span class="line">--<span class="built_in">help</span>：查看mysqlhotcopy帮助；</span><br><span class="line">--allowold：如果备份目录下存在相同的备份文件，将旧的备份文件加上_old；</span><br><span class="line">--keepold：如果备份目录下存在相同的备份文件，不删除旧的备份文件，而是将旧的文件更名；</span><br><span class="line">--flushlog：本次辈分之后，将对数据库的更新记录到日志中；</span><br><span class="line">--noindices：只备份数据文件，不备份索引文件；</span><br><span class="line">--user=用户名：用来指定用户名，可以用-u代替；</span><br><span class="line">--password=密码：用来指定密码，可以用-p代替。使用-p时，密码与-p之间没有空格；</span><br><span class="line">--port=端口号：用来指定访问端口，可以用-P代替；</span><br><span class="line">--socket=socket文件：用来指定socket文件，可以用-S代替；</span><br></pre></td></tr></table></figure>
<p>mysqlhotcopy并非mysql自带，需要安装Perl的数据库接口包；下载地址为:<a target="_blank" rel="noopener" href="http://dev.mysql.com/downloads/dbi.html">http://dev.mysql.com/downloads/dbi.html</a>  </p>
<p>目前，该工具也仅仅能够备份MyISAM类型的表  </p>
<h2 id="数据库恢复"><a href="#数据库恢复" class="headerlink" title="数据库恢复"></a>数据库恢复</h2><h3 id="还原直接复制目录的备份"><a href="#还原直接复制目录的备份" class="headerlink" title="还原直接复制目录的备份"></a>还原直接复制目录的备份</h3><p>通过这种方式还原时，必须保证两个MySQL数据库的版本号是相同的。MyISAM类型的表有效，对于InnoDB类型的表不可用，InnoDB表的表空间不能直接复制。</p>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="mysql查询表的数据大小"><a href="#mysql查询表的数据大小" class="headerlink" title="mysql查询表的数据大小"></a>mysql查询表的数据大小</h3><h4 id="information-schema"><a href="#information-schema" class="headerlink" title="information_schema"></a>information_schema</h4><p>在mysql中有一个information_schema数据库，这个数据库中装的是mysql的元数据，包括数据库信息、数据库中表的信息等。所以要想查询数据库占用磁盘的空间大小可以通过对information_schema数据库进行操作。</p>
<style type="text/css">
.tg  {border-collapse:collapse;border-color:#bbb;border-spacing:0;}
.tg td{background-color:#E0FFEB;border-color:#bbb;border-style:solid;border-width:1px;color:#594F4F;
  font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;word-break:normal;}
.tg th{background-color:#9DE0AD;border-color:#bbb;border-style:solid;border-width:1px;color:#493F3F;
  font-family:Arial, sans-serif;font-size:14px;font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;}
.tg .tg-0lax{text-align:left;vertical-align:top}
</style>
<table class="tg">
<thead>
  <tr>
    <th class="tg-0lax">&nbsp;&nbsp;&nbsp;关键表&nbsp;&nbsp;&nbsp;</th>
    <th class="tg-0lax">&nbsp;&nbsp;&nbsp;作用&nbsp;&nbsp;&nbsp;</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;schemata&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;这个表里面主要是存储在mysql中的所有的数据库的信息&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;tables&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;这个表里存储了所有数据库中的表的信息，包括每个表有多少个列等信息&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;columns&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;这个表存储了所有表中的表字段信息&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;statistics&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;存储了表中索引的信息&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;user_privileges&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;存储了用户的权限信息&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;schema_privileges&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;存储了数据库权限&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;table_privileges&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;存储了表的权限&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;column_privileges&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;存储了列的权限信息&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;character_sets&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;存储了mysql可以用的字符集的信息&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;collations&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;提供各个字符集的对照信息&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;collation_character_set_applicability&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;相当于collations表和character_sets表的前两个字段的一个对比，记录了字符集之间的对照信息。&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;table_constraints&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;这个表主要是用于记录表的描述存在约束的表和约束类型&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;key_column_usage&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;记录具有约束的列&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;routines&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;记录了存储过程和函数的信息，不包含自定义的过程或函数信息。&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;views&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;记录了视图信息，需要有show view权限&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;triggers&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;存储了触发器的信息，需要有super权限&nbsp;&nbsp;&nbsp;</td>
  </tr>
</tbody>
</table>

<h3 id="要查询表所占的容量，就是把表的数据和索引加起来就可以了"><a href="#要查询表所占的容量，就是把表的数据和索引加起来就可以了" class="headerlink" title="要查询表所占的容量，就是把表的数据和索引加起来就可以了"></a>要查询表所占的容量，就是把表的数据和索引加起来就可以了</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(DATA_LENGTH)<span class="operator">+</span><span class="built_in">sum</span>(INDEX_LENGTH) <span class="keyword">from</span> information_schema.tables  <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;数据库名&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h3 id="查询所有的数据大小"><a href="#查询所有的数据大小" class="headerlink" title="查询所有的数据大小"></a>查询所有的数据大小</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> concat(round(<span class="built_in">sum</span>(DATA_LENGTH<span class="operator">/</span><span class="number">1024</span><span class="operator">/</span><span class="number">1024</span>),<span class="number">2</span>),<span class="string">&#x27;M&#x27;</span>) <span class="keyword">from</span> tables; <span class="comment">-- 查询所有的数据大小</span></span><br></pre></td></tr></table></figure>
<h3 id="查询某个表的数据"><a href="#查询某个表的数据" class="headerlink" title="查询某个表的数据"></a>查询某个表的数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> concat(round(<span class="built_in">sum</span>(DATA_LENGTH<span class="operator">/</span><span class="number">1024</span><span class="operator">/</span><span class="number">1024</span>),<span class="number">2</span>),<span class="string">&#x27;M&#x27;</span>) <span class="keyword">from</span> tables <span class="keyword">where</span> table_schema<span class="operator">=</span>’数据库名’ <span class="keyword">AND</span> table_name<span class="operator">=</span>’表名’;</span><br></pre></td></tr></table></figure>
<h3 id="mysqldump参数汇总"><a href="#mysqldump参数汇总" class="headerlink" title="mysqldump参数汇总"></a>mysqldump参数汇总</h3><style type="text/css">
.tg  {border-collapse:collapse;border-color:#bbb;border-spacing:0;}
.tg td{background-color:#E0FFEB;border-color:#bbb;border-style:solid;border-width:1px;color:#594F4F;
  font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;word-break:normal;}
.tg th{background-color:#9DE0AD;border-color:#bbb;border-style:solid;border-width:1px;color:#493F3F;
  font-family:Arial, sans-serif;font-size:14px;font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;}
.tg .tg-0lax{text-align:left;vertical-align:top}
</style>
<table class="tg">
<thead>
  <tr>
    <th class="tg-0lax">&nbsp;&nbsp;&nbsp;参数&nbsp;&nbsp;&nbsp;</th>
    <th class="tg-0lax">&nbsp;&nbsp;&nbsp;说明&nbsp;&nbsp;&nbsp;</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--all-databases ,&nbsp;&nbsp;&nbsp;-A&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;导出全部数据库。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--all-tablespaces&nbsp;&nbsp;&nbsp;, -Y&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;导出全部表空间。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases --all-tablespaces&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--no-tablespaces ,&nbsp;&nbsp;&nbsp;-y&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;不导出任何表空间信息。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases --no-tablespaces&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--add-drop-database&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;每个数据库创建之前添加drop数据库语句。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases&nbsp;&nbsp;&nbsp;--add-drop-database&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--add-drop-table&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;每个数据表创建之前添加drop数据表语句。(默认为打开状态，使用--skip-add-drop-table取消选项)&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p&nbsp;&nbsp;&nbsp;--all-databases  (默认添加drop语句)&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p&nbsp;&nbsp;&nbsp;--all-databases --skip-add-drop-table  (取消drop语句)&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--add-locks&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;在每个表导出之前增加LOCK TABLES并且之后UNLOCK  TABLE。(默认为打开状态，使用--skip-add-locks取消选项)&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases  (默认添加LOCK语句)&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases --skip-add-locks   (取消LOCK语句)&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--allow-keywords&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;允许创建是关键词的列名字。这由表名前缀于每个列名做到。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases --allow-keywords&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--apply-slave-statements&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;在'CHANGE MASTER'前添加'STOP&nbsp;&nbsp;&nbsp;SLAVE'，并且在导出的最后添加'START SLAVE'。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases&nbsp;&nbsp;&nbsp;--apply-slave-statements&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--character-sets-dir&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;字符集文件的目录&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases &nbsp;&nbsp;&nbsp;--character-sets-dir=/usr/local/mysql/share/mysql/charsets&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--comments&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;附加注释信息。默认为打开，可以用--skip-comments取消&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p&nbsp;&nbsp;&nbsp;--all-databases  (默认记录注释)&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p&nbsp;&nbsp;&nbsp;--all-databases --skip-comments   (取消注释)&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--compatible&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;导出的数据将和其它数据库或旧版本的MySQL&nbsp;&nbsp;&nbsp;相兼容。值可以为ansi、mysql323、mysql40、postgresql、oracle、mssql、db2、maxdb、no_key_options、no_tables_options、no_field_options等，&nbsp;&nbsp;&nbsp;要使用几个值，用逗号将它们隔开。它并不保证能完全兼容，而是尽量兼容。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases --compatible=ansi&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--compact&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;导出更少的输出信息(用于调试)。去掉注释和头尾等结构。可以使用选项：--skip-add-drop-table  --skip-add-locks --skip-comments&nbsp;&nbsp;&nbsp;--skip-disable-keys&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases --compact&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--complete-insert,&nbsp;&nbsp;&nbsp;-c&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;使用完整的insert语句(包含列名称)。这么做能提高插入效率，但是可能会受到max_allowed_packet参数的影响而导致插入失败。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases --complete-insert&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--compress, -C&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;在客户端和服务器之间启用压缩传递所有信息&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases --compress&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--create-options,&nbsp;&nbsp;&nbsp;-a&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;在CREATE TABLE语句中包括所有MySQL特性选项。(默认为打开状态)&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--databases, -B&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;导出几个数据库。参数后面所有名字参量都被看作数据库名。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --databases test mysql&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--debug&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;输出debug信息，用于调试。默认值为：d:t:o,/tmp/mysqldump.trace&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases --debug&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases --debug=”&nbsp;&nbsp;&nbsp;d:t:o,/tmp/debug.trace”&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--debug-check&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;检查内存和打开文件使用说明并退出。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases --debug-check&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--debug-info&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;输出调试信息并退出&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases --debug-info&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--default-character-set&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;设置默认字符集，默认值为utf8&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases&nbsp;&nbsp;&nbsp;--default-character-set=latin1&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--delayed-insert&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;采用延时插入方式（INSERT DELAYED）导出数据&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases --delayed-insert&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--delete-master-logs&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;master备份后删除日志. 这个参数将自动激活--master-data。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases&nbsp;&nbsp;&nbsp;--delete-master-logs&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--disable-keys&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;对于每个表，用/*!40000 ALTER TABLE tbl_name&nbsp;&nbsp;&nbsp;DISABLE KEYS */;和/*!40000 ALTER TABLE tbl_name ENABLE KEYS&nbsp;&nbsp;&nbsp;*/;语句引用INSERT语句。这样可以更快地导入dump出来的文件，因为它是在插入所有行后创建索引的。该选项只适合MyISAM表，默认为打开状态。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases&nbsp;&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--dump-slave&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;该选项将导致主的binlog位置和文件名追加到导出数据的文件中。设置为1时，将会以CHANGE&nbsp;&nbsp;&nbsp;MASTER命令输出到数据文件；设置为2时，在命令前增加说明信息。该选项将会打开--lock-all-tables，除非--single-transaction被指定。该选项会自动关闭--lock-tables选项。默认值为0。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases --dump-slave=1&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases --dump-slave=2&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--events, -E&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;导出事件。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases --events&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--extended-insert,&nbsp;&nbsp;&nbsp;-e&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;使用具有多个VALUES列的INSERT语法。这样使导出文件更小，并加速导入时的速度。默认为打开状态，使用--skip-extended-insert取消选项。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p&nbsp;&nbsp;&nbsp;--all-databases--skip-extended-insert  &nbsp;&nbsp;&nbsp;(取消选项)&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--fields-terminated-by&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;导出文件中忽略给定字段。与--tab选项一起使用，不能用于--databases和--all-databases选项&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p test test --tab=”/home/mysql”&nbsp;&nbsp;&nbsp;--fields-terminated-by=”#”&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--fields-enclosed-by&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;输出文件中的各个字段用给定字符包裹。与--tab选项一起使用，不能用于--databases和--all-databases选项&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p test test --tab=”/home/mysql”&nbsp;&nbsp;&nbsp;--fields-enclosed-by=”#”&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--fields-optionally-enclosed-by&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;输出文件中的各个字段用给定字符选择性包裹。与--tab选项一起使用，不能用于--databases和--all-databases选项&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p test test&nbsp;&nbsp;&nbsp;--tab=”/home/mysql” &nbsp;&nbsp;&nbsp;--fields-enclosed-by=”#” --fields-optionally-enclosed =”#”&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--fields-escaped-by&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;输出文件中的各个字段忽略给定字符。与--tab选项一起使用，不能用于--databases和--all-databases选项&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p mysql user --tab=”/home/mysql”&nbsp;&nbsp;&nbsp;--fields-escaped-by=”#”&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--flush-logs&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;开始导出之前刷新日志。&nbsp;&nbsp;&nbsp;请注意：假如一次导出多个数据库(使用选项--databases或者--all-databases)，将会逐个数据库刷新日志。除使用--lock-all-tables或者--master-data外。在这种情况下，日志将会被刷新一次，相应的所以表同时被锁定。因此，如果打算同时导出和刷新日志应该使用--lock-all-tables&nbsp;&nbsp;&nbsp;或者--master-data 和--flush-logs。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases --flush-logs&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--flush-privileges&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;在导出mysql数据库之后，发出一条FLUSH  PRIVILEGES&nbsp;&nbsp;&nbsp;语句。为了正确恢复，该选项应该用于导出mysql数据库和依赖mysql数据库数据的任何时候。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases&nbsp;&nbsp;&nbsp;--flush-privileges&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--force&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;在导出过程中忽略出现的SQL错误。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases --force&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--help&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;显示帮助信息并退出。&nbsp;&nbsp;&nbsp;mysqldump  --help&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--hex-blob&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;使用十六进制格式导出二进制字符串字段。如果有二进制数据就必须使用该选项。影响到的字段类型有BINARY、VARBINARY、BLOB。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --all-databases --hex-blob&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--host, -h&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;需要导出的主机信息&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--ignore-table&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;不导出指定表。指定忽略多个表时，需要重复多次，每次一个表。每个表必须同时指定数据库和表名。例如：--ignore-table=database.table1 --ignore-table=database.table2 ……&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--ignore-table=mysql.user&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--include-master-host-port&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;在--dump-slave产生的'CHANGE  MASTER&nbsp;&nbsp;&nbsp;TO..'语句中增加'MASTER_HOST=&lt;host&gt;，MASTER_PORT=&lt;port&gt;' &nbsp;&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--include-master-host-port&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--insert-ignore&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;在插入行时使用INSERT IGNORE语句.&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--insert-ignore&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--lines-terminated-by&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;输出文件的每行用给定字符串划分。与--tab选项一起使用，不能用于--databases和--all-databases选项。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost test test&nbsp;&nbsp;&nbsp;--tab=”/tmp/mysql” &nbsp;&nbsp;&nbsp;--lines-terminated-by=”##”&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--lock-all-tables,&nbsp;&nbsp;&nbsp;-x&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;提交请求锁定所有数据库中的所有表，以保证数据的一致性。这是一个全局读锁，并且自动关闭--single-transaction&nbsp;&nbsp;&nbsp;和--lock-tables 选项。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--lock-all-tables&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--lock-tables, -l&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;开始导出前，锁定所有表。用READ &nbsp;&nbsp;&nbsp;LOCAL锁定表以允许MyISAM表并行插入。对于支持事务的表例如InnoDB和BDB，--single-transaction是一个更好的选择，因为它根本不需要锁定表。&nbsp;&nbsp;&nbsp;请注意当导出多个数据库时，--lock-tables分别为每个数据库锁定表。因此，该选项不能保证导出文件中的表在数据库之间的逻辑一致性。不同数据库表的导出状态可以完全不同。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--lock-tables&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--log-error&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;附加警告和错误信息到给定文件&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost&nbsp;&nbsp;&nbsp;--all-databases &nbsp;&nbsp;&nbsp;--log-error=/tmp/mysqldump_error_log.err&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--master-data&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;该选项将binlog的位置和文件名追加到输出文件中。如果为1，将会输出CHANGE&nbsp;&nbsp;&nbsp;MASTER 命令；如果为2，输出的CHANGE &nbsp;&nbsp;&nbsp;MASTER命令前添加注释信息。该选项将打开--lock-all-tables&nbsp;&nbsp;&nbsp;选项，除非--single-transaction也被指定（在这种情况下，全局读锁在开始导出时获得很短的时间；其他内容参考下面的--single-transaction选项）。该选项自动关闭--lock-tables选项。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--master-data=1;&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--master-data=2;&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--max_allowed_packet&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;服务器发送和接受的最大包长度。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--max_allowed_packet=10240&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--net_buffer_length&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;TCP/IP和socket连接的缓存大小。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--net_buffer_length=1024&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--no-autocommit&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;使用autocommit/commit 语句包裹表。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--no-autocommit&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--no-create-db, -n&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;只导出数据，而不添加CREATE DATABASE 语句。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--no-create-db&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--no-create-info,&nbsp;&nbsp;&nbsp;-t&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;只导出数据，而不添加CREATE TABLE 语句。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--no-create-info&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--no-data, -d&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;不导出任何数据，只导出数据库表结构。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--no-data&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--no-set-names, -N&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;等同于--skip-set-charset&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--no-set-names&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--opt&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;等同于--add-drop-table,  --add-locks, --create-options, --quick,&nbsp;&nbsp;&nbsp;--extended-insert, --lock-tables, &nbsp;&nbsp;&nbsp;--set-charset, --disable-keys 该选项默认开启, &nbsp;&nbsp;&nbsp;可以用--skip-opt禁用.&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--opt&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--order-by-primary&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;如果存在主键，或者第一个唯一键，对每个表的记录进行排序。在导出MyISAM表到InnoDB表时有效，但会使得导出工作花费很长时间。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--order-by-primary&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--password, -p&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;连接数据库密码&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--pipe(windows系统可用)&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;使用命名管道连接mysql&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--pipe&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--port, -P&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;连接数据库端口号&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--protocol&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;使用的连接协议，包括：tcp, socket, pipe, memory.&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--protocol=tcp&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--quick, -q&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;不缓冲查询，直接导出到标准输出。默认为打开状态，使用--skip-quick取消该选项。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--skip-quick&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--quote-names,-Q&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;使用（`）引起表和列名。默认为打开状态，使用--skip-quote-names取消该选项。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--skip-quote-names&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--replace&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;使用REPLACE INTO 取代INSERT INTO.&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--replace&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--result-file, -r&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;直接输出到指定文件中。该选项应该用在使用回车换行对（\\r\\n）换行的系统上（例如：DOS，Windows）。该选项确保只有一行被使用。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--result-file=/tmp/mysqldump_result_file.txt&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--routines, -R&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;导出存储过程以及自定义函数。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--routines&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--set-charset&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;添加'SET NAMES &nbsp;&nbsp;&nbsp;default_character_set'到输出文件。默认为打开状态，使用--skip-set-charset关闭选项。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--skip-set-charset&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--single-transaction&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;该选项在导出数据之前提交一个BEGIN SQL语句，BEGIN&nbsp;&nbsp;&nbsp;不会阻塞任何应用程序且能保证导出时数据库的一致性状态。它只适用于多版本存储引擎，仅InnoDB。本选项和--lock-tables 选项是互斥的，因为LOCK &nbsp;&nbsp;&nbsp;TABLES 会使任何挂起的事务隐含提交。要想导出大表的话，应结合使用--quick 选项。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--single-transaction&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--dump-date&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;将导出时间添加到输出文件中。默认为打开状态，使用--skip-dump-date关闭选项。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--skip-dump-date&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--skip-opt&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;禁用–opt选项.&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--skip-opt&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--socket,-S&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;指定连接mysql的socket文件位置，默认路径/tmp/mysql.sock&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--socket=/tmp/mysqld.sock&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--tab,-T&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;为每个表在给定路径创建tab分割的文本文件。注意：仅仅用于mysqldump和mysqld服务器运行在相同机器上。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost test test&nbsp;&nbsp;&nbsp;--tab="/home/mysql"&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--tables&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;覆盖--databases (-B)参数，指定需要导出的表名。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --databases test&nbsp;&nbsp;&nbsp;--tables test&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--triggers&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;导出触发器。该选项默认启用，用--skip-triggers禁用它。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--triggers&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--tz-utc&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;在导出顶部设置时区TIME_ZONE='+00:00'&nbsp;&nbsp;&nbsp;，以保证在不同时区导出的TIMESTAMP 数据或者数据被移动其他时区时的正确性。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--tz-utc&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--user, -u&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;指定连接的用户名。&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--verbose, --v&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;输出多种平台信息。&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--version, -V&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;输出mysqldump版本信息并退出&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;-where, -w&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;只转储给定的WHERE条件选择的记录。请注意如果条件包含命令解释符专用空格或字符，一定要将条件引用起来。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--where=” user=’root’”&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--xml, -X&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;导出XML格式.&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--xml&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--plugin_dir&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;客户端插件的目录，用于兼容不同的插件版本。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--plugin_dir=”/usr/local/lib/plugin”&nbsp;&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;--default_auth&nbsp;&nbsp;&nbsp;</td>
    <td class="tg-0lax">&nbsp;&nbsp;&nbsp;客户端插件默认使用权限。&nbsp;&nbsp;&nbsp;mysqldump  -uroot -p --host=localhost --all-databases&nbsp;&nbsp;&nbsp;--default-auth=”/usr/local/lib/plugin/&lt;PLUGIN&gt;”&nbsp;&nbsp;&nbsp;</td>
  </tr>
</tbody>
</table>

<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol>
<li><a target="_blank" rel="noopener" href="https://www.jb51.net/article/41570.htm">mysql备份的三种方式详解</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/roverliang/p/6436140.html">MySQL备份与恢复</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/ivictor/p/5505307.html">mysqldump的实现原理</a></li>
</ol>

    </div>

    
    
    
        <div class="reward-container">
  <div></div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.png" alt="Theodore Sun 微信支付">
        <p>微信支付</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.png" alt="Theodore Sun 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/MySQL/" rel="tag"><i class="fa fa-tag"></i> MySQL</a>
              <a href="/tags/%E5%A4%87%E4%BB%BD/" rel="tag"><i class="fa fa-tag"></i> 备份</a>
              <a href="/tags/%E6%81%A2%E5%A4%8D/" rel="tag"><i class="fa fa-tag"></i> 恢复</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/02/04/MySQL%E4%B9%8B%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7/" rel="prev" title="MySQL之优化技巧">
      <i class="fa fa-chevron-left"></i> MySQL之优化技巧
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/02/04/MySQL%E4%B9%8B%E9%AB%98%E5%8F%AF%E7%94%A8/" rel="next" title="MySQL之高可用">
      MySQL之高可用 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
      <!--网易云插件-->
      <iframe frameborder="no" border="0" marginwidth="0" 
          marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=569213220&auto=0&height=66">
      </iframe>

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%B4%E6%98%8E"><span class="nav-number">1.</span> <span class="nav-text">说明</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%87%E4%BB%BD%E7%9A%84%E7%9B%AE%E7%9A%84"><span class="nav-number">1.1.</span> <span class="nav-text">备份的目的</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%87%E4%BB%BD%E9%9C%80%E8%A6%81%E8%80%83%E8%99%91%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-number">1.2.</span> <span class="nav-text">备份需要考虑的问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%87%E4%BB%BD%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.3.</span> <span class="nav-text">备份的类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B9%E6%8D%AE%E6%98%AF%E5%90%A6%E9%9C%80%E8%A6%81%E6%95%B0%E6%8D%AE%E5%BA%93%E7%A6%BB%E7%BA%BF"><span class="nav-number">1.3.1.</span> <span class="nav-text">根据是否需要数据库离线</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B9%E6%8D%AE%E8%A6%81%E5%A4%87%E4%BB%BD%E7%9A%84%E6%95%B0%E6%8D%AE%E9%9B%86%E5%90%88%E7%9A%84%E8%8C%83%E5%9B%B4"><span class="nav-number">1.3.2.</span> <span class="nav-text">根据要备份的数据集合的范围</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B9%E6%8D%AE%E5%A4%87%E4%BB%BD%E6%95%B0%E6%8D%AE%E6%88%96%E6%96%87%E4%BB%B6"><span class="nav-number">1.3.3.</span> <span class="nav-text">根据备份数据或文件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%87%E4%BB%BD%E5%AF%B9%E8%B1%A1"><span class="nav-number">1.4.</span> <span class="nav-text">备份对象</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E4%BB%BD%E4%B8%8E%E8%BF%98%E5%8E%9F"><span class="nav-number">2.</span> <span class="nav-text">数据库备份与还原</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A9%E7%94%A8select-into-outfile%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E7%9A%84%E5%A4%87%E4%BB%BD%E4%B8%8E%E8%BF%98%E5%8E%9F"><span class="nav-number">2.1.</span> <span class="nav-text">利用select into outfile实现数据的备份与还原</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%87%E4%BB%BD%E6%95%B0%E6%8D%AE"><span class="nav-number">2.1.1.</span> <span class="nav-text">备份数据</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%94%99%E8%AF%AF%E5%88%86%E6%9E%90"><span class="nav-number">2.1.1.1.</span> <span class="nav-text">错误分析</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9"><span class="nav-number">2.1.1.2.</span> <span class="nav-text">文件内容</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%81%A2%E5%A4%8D"><span class="nav-number">2.1.2.</span> <span class="nav-text">数据恢复</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E4%BE%8B%E5%AD%90"><span class="nav-number">2.1.3.</span> <span class="nav-text">其他例子</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8mysqldump%E5%A4%87%E4%BB%BD%E6%95%B0%E6%8D%AE%E5%92%8C%E8%BF%98%E5%8E%9F%E6%95%B0%E6%8D%AE"><span class="nav-number">2.2.</span> <span class="nav-text">使用mysqldump备份数据和还原数据</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%B4%E6%98%8E-1"><span class="nav-number">2.2.1.</span> <span class="nav-text">说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%AD%E6%B3%95"><span class="nav-number">2.2.2.</span> <span class="nav-text">语法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A4%87%E4%BB%BD%E4%B8%80%E4%B8%AA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">2.2.2.1.</span> <span class="nav-text">备份一个数据库</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A4%87%E4%BB%BD%E5%A4%9A%E4%B8%AA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">2.2.2.2.</span> <span class="nav-text">备份多个数据库</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A4%87%E4%BB%BD%E5%85%A8%E9%83%A8%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">2.2.2.3.</span> <span class="nav-text">备份全部数据库</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%BD%E5%8A%A0%E8%AF%BB%E9%94%81%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="nav-number">2.2.3.</span> <span class="nav-text">施加读锁的方式</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%9B%B4%E6%8E%A5%E5%9C%A8%E5%A4%87%E4%BB%BD%E7%9A%84%E6%97%B6%E5%80%99%E6%B7%BB%E5%8A%A0%E9%80%89%E9%A1%B9"><span class="nav-number">2.2.3.1.</span> <span class="nav-text">直接在备份的时候添加选项</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9C%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E4%B9%A6%E5%86%99%E5%91%BD%E4%BB%A4"><span class="nav-number">2.2.3.2.</span> <span class="nav-text">在服务器端书写命令</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%87%E4%BB%BD%E7%AD%96%E7%95%A5"><span class="nav-number">2.2.4.</span> <span class="nav-text">备份策略</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%8C%E6%95%B4%E5%A4%87%E4%BB%BD%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">2.2.5.</span> <span class="nav-text">完整备份数据库</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E4%BF%A1%E6%81%AF"><span class="nav-number">2.2.5.1.</span> <span class="nav-text">文件信息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9-1"><span class="nav-number">2.2.5.2.</span> <span class="nav-text">文件内容</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9general-log"><span class="nav-number">2.2.6.</span> <span class="nav-text">日志文件内容general log</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#FLUSH-40101-LOCAL-TABLES"><span class="nav-number">2.2.6.1.</span> <span class="nav-text">FLUSH &#x2F;*!40101 LOCAL *&#x2F; TABLES</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#FLUSH-TABLES-WITH-READ-LOCK"><span class="nav-number">2.2.6.2.</span> <span class="nav-text">FLUSH TABLES WITH READ LOCK</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#SET-SESSION-TRANSACTION-ISOLATION-LEVEL-REPEATABLE-READ"><span class="nav-number">2.2.6.3.</span> <span class="nav-text">SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#START-TRANSACTION-40100-WITH-CONSISTENT-SNAPSHOT"><span class="nav-number">2.2.6.4.</span> <span class="nav-text">START TRANSACTION &#x2F;*!40100 WITH CONSISTENT SNAPSHOT *&#x2F;</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#SHOW-MASTER-STATUS"><span class="nav-number">2.2.6.5.</span> <span class="nav-text">SHOW MASTER STATUS</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#UNLOCK-TABLES"><span class="nav-number">2.2.6.6.</span> <span class="nav-text">UNLOCK TABLES</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9C%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%89%A7%E8%A1%8C%E7%9B%B8%E5%85%B3sql%EF%BC%8C%E7%84%B6%E5%90%8E%E6%9F%A5%E7%9C%8B%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%97%A5%E5%BF%97%E7%9A%84%E8%AE%B0%E5%BD%95%E4%BD%8D%E7%BD%AE"><span class="nav-number">2.2.7.</span> <span class="nav-text">在服务器端执行相关sql，然后查看二进制日志的记录位置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD"><span class="nav-number">2.2.8.</span> <span class="nav-text">增量备份</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%81%A2%E5%A4%8D%E6%95%B0%E6%8D%AE"><span class="nav-number">2.2.9.</span> <span class="nav-text">恢复数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="nav-number">2.2.10.</span> <span class="nav-text">注意事项</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%B4%E6%8E%A5%E5%A4%8D%E5%88%B6%E6%95%B4%E4%B8%AA%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9B%AE%E5%BD%95"><span class="nav-number">2.3.</span> <span class="nav-text">直接复制整个数据库目录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8mysqlhotcopy%E5%B7%A5%E5%85%B7%E5%BF%AB%E9%80%9F%E5%A4%87%E4%BB%BD"><span class="nav-number">2.4.</span> <span class="nav-text">使用mysqlhotcopy工具快速备份</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%81%A2%E5%A4%8D"><span class="nav-number">3.</span> <span class="nav-text">数据库恢复</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%98%E5%8E%9F%E7%9B%B4%E6%8E%A5%E5%A4%8D%E5%88%B6%E7%9B%AE%E5%BD%95%E7%9A%84%E5%A4%87%E4%BB%BD"><span class="nav-number">3.1.</span> <span class="nav-text">还原直接复制目录的备份</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B6%E4%BB%96"><span class="nav-number">4.</span> <span class="nav-text">其他</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#mysql%E6%9F%A5%E8%AF%A2%E8%A1%A8%E7%9A%84%E6%95%B0%E6%8D%AE%E5%A4%A7%E5%B0%8F"><span class="nav-number">4.1.</span> <span class="nav-text">mysql查询表的数据大小</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#information-schema"><span class="nav-number">4.1.1.</span> <span class="nav-text">information_schema</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A6%81%E6%9F%A5%E8%AF%A2%E8%A1%A8%E6%89%80%E5%8D%A0%E7%9A%84%E5%AE%B9%E9%87%8F%EF%BC%8C%E5%B0%B1%E6%98%AF%E6%8A%8A%E8%A1%A8%E7%9A%84%E6%95%B0%E6%8D%AE%E5%92%8C%E7%B4%A2%E5%BC%95%E5%8A%A0%E8%B5%B7%E6%9D%A5%E5%B0%B1%E5%8F%AF%E4%BB%A5%E4%BA%86"><span class="nav-number">4.2.</span> <span class="nav-text">要查询表所占的容量，就是把表的数据和索引加起来就可以了</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2%E6%89%80%E6%9C%89%E7%9A%84%E6%95%B0%E6%8D%AE%E5%A4%A7%E5%B0%8F"><span class="nav-number">4.3.</span> <span class="nav-text">查询所有的数据大小</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2%E6%9F%90%E4%B8%AA%E8%A1%A8%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="nav-number">4.4.</span> <span class="nav-text">查询某个表的数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mysqldump%E5%8F%82%E6%95%B0%E6%B1%87%E6%80%BB"><span class="nav-number">4.5.</span> <span class="nav-text">mysqldump参数汇总</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-number">5.</span> <span class="nav-text">参考</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Theodore Sun"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Theodore Sun</p>
  <div class="site-description" itemprop="description">心之所向，素履以往</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">100</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">27</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">154</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/sld880311" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;sld880311" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="fa fa-rss fa-fw"></i>RSS</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      友情链接
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.csdn.net/" title="https:&#x2F;&#x2F;www.csdn.net" rel="noopener" target="_blank">CSDN</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        
  <div class="languages">
    <label class="lang-select-label">
      <i class="fa fa-language"></i>
      <span>简体中文</span>
      <i class="fa fa-angle-up" aria-hidden="true"></i>
    </label>
    <select class="lang-select" data-canonical="">
      
        <option value="zh-CN" data-href="/2021/02/04/MySQL%E4%B9%8B%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D/" selected="">
          简体中文
        </option>
      
        <option value="en" data-href="/en/2021/02/04/MySQL%E4%B9%8B%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D/" selected="">
          English
        </option>
      
    </select>
  </div>

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Theodore Sun</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">856k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">12:59</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>









<script>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>




  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '1c5d7704f735e90e9f0a',
      clientSecret: 'b4d961f25b2fd71d6744910fdc43f332b259c401',
      repo        : 'sld880311.github.io',
      owner       : 'sld880311',
      admin       : ['sld880311'],
      id          : '3c43d2e3820e1a72d1e8f62b6d0c19db',
        language: 'zh-CN',
      distractionFreeMode: false
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
<script type="text/javascript" src="/js/src/clicklove.js"></script>
